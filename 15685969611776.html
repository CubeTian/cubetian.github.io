<!doctype html>
<html lang="zh-cn">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,minimum-scale=1" />
    <title>
        
      SAS DATA步之全揭秘 - 程序猿CubeTian
      
    </title>
    
      <meta name="twitter:card" content="summary_large_image" />
      <meta name="twitter:creator" content="@Astrian_Zheng" />
      <meta property="og:url" content="https://cubetian.github.io/15685969611776.html" />
      <meta property="og:title" content="SAS DATA步之全揭秘" />
      
        <meta property="og:description" content="SAS DATA步之全揭秘" />
      
      
      <meta property="og:site_name" content="程序猿CubeTian" />
    
    
    <link href="atom.xml" rel="alternate" title="程序猿CubeTian" type="application/atom+xml">
    <script src="https://cdn.bootcss.com/moment.js/2.24.0/moment.min.js"></script>
    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="asset/style.css">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  </head>
  <body>
    <div class="container">
      <div class="head">
        <div class="row">
          <div class="col-md-12">
            <div class="blogname">程序猿CubeTian</div>
            <nav>
              
                <div class="item"><a target="self" href="index.html">Home</a></div>
              
                <div class="item"><a target="_self" href="archives.html">Archives</a></div>
              
            </nav>
          </div>
        </div>
      </div>
      <hr>
    </div> <div class="container" id="post">
  <div class="article huge">
    <div class="featureimg" style="background-image: url('asset/defaultfeaimg.jpg')"></div>
    <img src="" style="display: none;" class="featureimgforexternal">
    <div class="timeGTM" style="display:none;">2019-09-16T09:22:41+08:00</div>
    <div class="row content">
      <div class="col-md-2"></div>
      <div class="col-md-10 main">
        <div class="row">
          <div class="col-md-10">
            <div class="post">
              <div class="headline"><a href="15685969611776.html">SAS DATA步之全揭秘</a></div>
              
              <div class="time">$[timeformat('2019-09-16T09:22:41+08:00')]</div>
              <div class="body">
                  <p>一些概念</p>

<ul>
<li>程序数据向量（PDV）</li>
<li>SAS自动变量名及其使用</li>
<li>理解DATA步内部处理过程</li>
<li>代码编译期间发生的事情</li>
<li>程序执行期间实际发生了什么</li>
<li>如何获取和存储变量属性</li>
</ul>

<p>DATA时建立SAS数据集的主要方法之一。一些涉及数据处理和创建数据集的任务可能只能通过DATA步才能解决<br/>
DATA步分编译和执行两个阶段，PDV贯穿SAS编译和执行的两个阶段，决定了信息在DATA步中的存储及变化</p>

<p>编译阶段包括：</p>

<ul>
<li>编译SAS语句，包括检查语法</li>
<li>创建一个输入缓存区（input buffer）（如果需要读入原始数据文件）、一个PDV和描述性信息</li>
</ul>

<p>执行阶段包括：</p>

<ul>
<li>计算DATA步迭代的次数（从DATA语句开始）</li>
<li>将PDV中所有变量设成缺失值并初始化自动变量</li>
<li>读取输入观测（从原始文件或SAS数据集）</li>
<li>执行附加的处理或计算语句</li>
<li>将一条数据记录写入输出数据集并返回到DATA步语句</li>
</ul>

<p>PDV贯穿编译的执行阶段：</p>

<ul>
<li>PDV是内存的一个临时逻辑区域，SAS建立数据集时，每条观察值只有一次机会用的PDV</li>
<li>包含所有变量的当前值</li>
<li>包含两个自动变量：_N_和_ERROR_</li>
</ul>

<p>DATA步<br/>
一个DATA步包含SAS语言的一组语句，这些语句具有以下功能</p>

<ul>
<li>从外部文件读入数据</li>
<li>将数据写入外部文件</li>
<li>读入SAS数据集和SAS视图</li>
<li>创建SAS数据集和SAS视图<br/>
一旦数据可以以SAS数据集的形式访问，就可以通过SAS过程步来分析数据和写报告</li>
</ul>

<p>可以运用DATA步：</p>

<ul>
<li>创建SAS数据集（SAS数据集或SAS视图）</li>
<li>根据包含原始数据（外部文件）和文件创建SAS数据集</li>
<li>通过提取子集、合并、修改和更新已经存在数据集的方式来创建新的数据集</li>
<li>分析、处理或展现数据</li>
<li>为新变量赋值（在有公式计算的情况下）</li>
<li>撰写报告或将文件写入磁盘或磁带</li>
<li>信息检索</li>
<li>文件管理<br/>
DATA步以‘DATA’语句开始（即显示的表明数据步的开始），以‘RUN’语句结束，在结束时会编译或执行RUN语句。在数据步最后一个观察值读取前，‘RUN’的功能都是以非显示的形式执行RETURN功能，去继续循环的操作。
<img src="media/15685969611776/15687662911534.png" alt=""/>
编译阶段<br/>
如上所示，DATA步的第一个阶段就为编译阶段。在编译阶段SAS的任务如下：</li>
<li>自动将SAS语句编译成将会在后面执行的机器语言</li>
<li>确定每个变量的类型和长度</li>
<li>确定变量是否有必要进行类型转换</li>
<li>如果有INPUT语句，为外部文件新建读取内存缓存区</li>
<li>创建PDV（Program Data Vector）</li>
<li>创建数据集和变量属性的描述性信息</li>
<li>处理语句，该项任务仅限于编译阶段；这为编译器如何新建变量提供信息；事实上，他们决定了如何在PDV内建立变量及信息；这些信息包括：DROP；KEEP；RENAME；RETAIN；RHERE；LABEL；LENGTH；FORMAT；ARRAY；BY；ATTRIB</li>
<li>创建自动变量：包括_N_,_ERROR_,RND=,IN=,FIRST,LAST,POINT=</li>
</ul>

              </div>
            </div>
            
            
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
    let post = new Vue({
     el: '#post',
     data: {
       hidelikecoin: ''
     },
     methods: {
       timeformat(raw) {
         return moment(raw).format("YYYY 年 MM 月 DD 日");
       }
     },
     delimiters: ['$[', ']']
   })
  </script>      <div class="container">
      <hr>
      <div class="footer" id="footer">
        <div class="slogan">众所周知，数学研究只需要一支笔和一堆草稿纸</div>
        <div class="meta">
          <p>又是学习的一天</p>
          <p>「程序猿CubeTian」使用 <a href="https://zh.mweb.im/" target="_blank">MWeb</a> 和 <a href="https://github.com/Astrian/reflect-white-mweb-theme" target="_blank">Reflect White</a> 搭建。</p>
        </div>
      </div>
      <script>
        let footer = new Vue({
          el: '#footer',
          data: {
            message: 'hello'
          },
          delimiters: ['$[', ']']
        })
      </script>
    </div>
  </div>
</body>
<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<style></style>
</html>